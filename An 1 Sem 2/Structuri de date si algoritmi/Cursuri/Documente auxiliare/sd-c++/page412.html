<HTML>
<HEAD>
<TITLE>Union by Height or Rank</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="cover75.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/cover75.gif" alt="Logo" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in C++</b><br>
<A NAME="tex2html7013" HREF="page413.html" tppabs="http://www.brpreiss.com/books/opus4/html/page413.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/next_motif.gif"></A> <A NAME="tex2html7011" HREF="page404.html" tppabs="http://www.brpreiss.com/books/opus4/html/page404.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/up_motif.gif"></A> <A NAME="tex2html7007" HREF="page411.html" tppabs="http://www.brpreiss.com/books/opus4/html/page411.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/previous_motif.gif"></A> <A NAME="tex2html7015" HREF="page9.html" tppabs="http://www.brpreiss.com/books/opus4/html/page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/contents_motif.gif"></A> <A NAME="tex2html7016" HREF="page620.html" tppabs="http://www.brpreiss.com/books/opus4/html/page620.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="index_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/index_motif.gif"></A> <BR><HR>
<H2><A NAME="SECTION0013440000000000000000">Union by Height or Rank</A></H2>
<P>
The union-by-size join algorithm described above controls the heights
of the trees indirectly by basing the join algorithm on the sizes of the trees.
If we explicitly keep track of the height of a node in the node itself,
we can accomplish the same thing.
<P>
Program&nbsp;<A HREF="page412.html#progpartition6c" tppabs="http://www.brpreiss.com/books/opus4/html/page412.html#progpartition6c"><IMG  ALIGN=BOTTOM ALT="gif" SRC="cross_ref_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/cross_ref_motif.gif"></A> gives an implementation of the <tt>Join</tt>
routine that always attaches the shorter tree under the root of the taller one.
This routine assumes that the <tt>rank</tt> field is used to keep
track of the height of a node.
(The reason for calling it <tt>rank</tt> rather than <tt>height</tt>
will become evident shortly).
<P>
<P><A NAME="30247">&#160;</A><A NAME="progpartition6c">&#160;</A> <IMG WIDTH=575 HEIGHT=295 ALIGN=BOTTOM ALT="program30032" SRC="img1699.gif" tppabs="http://www.brpreiss.com/books/opus4/html/img1699.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>PartitionAsForest</tt> Class 	Union-by-Rank <tt>Join</tt> Member Function Definition<BR>
<P>
<P>
The only time that the height of node increases is when
joining two trees that have the same height.
In this case, the height of the root increases by exactly one.
If the two trees being joined have different heights,
attaching the shorter tree under the root of the taller one
has no effect on the height of the root.
<P>
Unfortunately, there is a slight complication if we combine union-by-height
with the collapsing find.
Since the collapsing find works by moving nodes closer to the root,
it affects potentially the height of any node moved.
It is not at all clear how to recompute efficiently
the heights that have changed.
The solution is not to do it at all!
<P>
If we don't recompute the heights during the collapsing find operations,
then the heights will no longer be exact.
Nevertheless, the quantities remain useful estimates of the heights of nodes.
We call the estimated height of a node its <em>rank</em><A NAME=30042>&#160;</A>
and the join algorithm which uses rank instead of height
is called <em>union by rank</em><A NAME=30044>&#160;</A>.
<P>
Fortunately, Theorem&nbsp;<A HREF="page411.html#theoremsetsi" tppabs="http://www.brpreiss.com/books/opus4/html/page411.html#theoremsetsi"><IMG  ALIGN=BOTTOM ALT="gif" SRC="cross_ref_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/cross_ref_motif.gif"></A> applies equally well when when
union-by-rank is used.
I.e., the height of tree which contains <I>n</I> nodes is  <IMG WIDTH=56 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline59891" SRC="img403.gif" tppabs="http://www.brpreiss.com/books/opus4/html/img403.gif"  >.
Thus, the worst-case running time for the <tt>Find</tt> operation
grows logarithmically with <I>n</I>.
And as before, collapsing find only makes things better.
<P>
<HR><A NAME="tex2html7013" HREF="page413.html" tppabs="http://www.brpreiss.com/books/opus4/html/page413.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/next_motif.gif"></A> <A NAME="tex2html7011" HREF="page404.html" tppabs="http://www.brpreiss.com/books/opus4/html/page404.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/up_motif.gif"></A> <A NAME="tex2html7007" HREF="page411.html" tppabs="http://www.brpreiss.com/books/opus4/html/page411.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/previous_motif.gif"></A> <A NAME="tex2html7015" HREF="page9.html" tppabs="http://www.brpreiss.com/books/opus4/html/page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/contents_motif.gif"></A> <A NAME="tex2html7016" HREF="page620.html" tppabs="http://www.brpreiss.com/books/opus4/html/page620.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="index_motif.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/index_motif.gif"></A> <P><ADDRESS>
<img src="bruno.gif" tppabs="http://www.brpreiss.com/books/opus4/icons/bruno.gif" alt="Bruno" align=right>
<a href="copyright.html" tppabs="http://www.brpreiss.com/books/opus4/copyright.html">Copyright &#169; 1997</a> by <a href="signature.html" tppabs="http://www.brpreiss.com/books/opus4/signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>

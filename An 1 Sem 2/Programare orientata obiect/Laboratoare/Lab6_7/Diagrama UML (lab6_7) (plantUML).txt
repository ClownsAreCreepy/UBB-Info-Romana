@startuml

package Domain {
  class Disciplina <<Domain>> {
    - string nume
    - int ore
    - string tip
    - string profesor
    + getNume() : string
    + getOre() : int
    + getTip() : string
    + getProfesor() : string
  }
}

package Valid{
  class Validator <<Valid>> {
    - validTypes() : unordered_set
    + valideaza_disciplina(d : Disciplina)
    + valideaza_index(index : int, maxim : size_t)
    + valideaza_index_contract(index : int, maxim : size_t)
    + valideaza_ofstream(file_path : string)
  }

  class BaseException <<Valid>> {
    - string mesaj
    + getMesaj() : string
  }

  class FileException <<Valid>> {

  }

  class ValidationException <<Valid>> {

  }

  class RepoException <<Valid>> {

  }

  class ContractException <<Valid>> {

  }
}

package Repo{
  interface IRepoDisciplina <<interface>> {
    + {abstract} adauga(d : Disciplina)
    + {abstract} modifica(index : size_t, d : Disciplina)
    + {abstract} sterge(index : int)
    + {abstract} cauta(index : size_t) : Disciplina
    + {abstract} getAll() : vector<Disciplina>
    + {abstract} inserare_la_index(index : size_t, d : Disciplina)
  }

  class RepoDisciplinaMem <<Repo>> {
    ~ vector<Disciplina> discipline
    + adauga(d : Disciplina)
    + modifica(index : size_t, ot : Disciplina)
    + sterge(index : int)
    + cauta(size_t: int) : Disciplina
    + getAll() : vector<Disciplina>
    + inserare_la_index(...)
  }

  class RepoDisciplinaFile <<Repo>> {
    - string file_path
    - load_from_file()
    - save_to_file()
    + adauga(d : Disciplina)
    + modifica(index : size_t, ot : Disciplina)
    + sterge(index : int)
    + inserare_la_index(index : size_t, d : Disciplina)
  }

  class RepoDisciplinaFals <<Repo>> {
    - prob : double
    - data : map<int, Disciplina>
    - gen : mt19937
    - try_throw()
    + adauga(d : Disciplina)
    + modifica(index : size_t, d : Disciplina)
    + sterge(index : int)
    + cauta(index : size_t) : Disciplina
    + getAll() : vector<Disciplina>
    + inserare_la_index(index : size_t, d : Disciplina)
  }
}

package Contract{
  class ContractStudii <<Contract>> {
    - vector<Disciplina> contract
    + adauga(d : Disciplina)
    + goleste()
    + generare(all : vector<Disciplina>, nr : int)
    + getAll() : vector<Disciplina>
    + exporta_contract(out : ofstream)
  }
}

package DTO{
  class ReportDTO <<DTO>> {
    - int count
    + getCount() : int
  }
}

package Undo{
  Interface ActiuneUndo <<interface>> {
    + doUndo() <<abstract>>
  }

  class UndoAdauga {
    - repo : IRepoDisciplina
    + doUndo()
  }

  class UndoModifica {
    - repo : IRepoDisciplina
    - index : size_t
    - d_veche : Disciplina
    + doUndo()
  }

  class UndoSterge {
    - repo : IRepoDisciplina
    - index : size_t
    - d : Disciplina
    + doUndo()
  }
}

package Service{
  class ServiceDisciplina <<Service>> {
    - IRepoDisciplina& repo
    - ContractStudii contract
    - undoList : vector<unique_ptr<ActiuneUndo>>
    + adauga_service(...)
    + modifica_service(...)
    + sterge_service(index : int)
    + cauta_service(index : int) : Disciplina
    + getAll() : vector<Disciplina>
    + filtrare_ore(ore : int, out : vector<Disciplina>)
    + filtrare_profesor(...)
    + sortare_nume(out : vector<Disciplina>)
    + sortare_ore(out : vector<Disciplina>)
    + sortare_profesor_tip(out : vector<Disciplina>)
    + no_keywords : unordered_set
    + contract_adauga(...)
    + contract_generare(nr : int)
    + contract_getAll() : vector<Disciplina>
    + raport_tip() : unordered_map<string, ReportDTO>
    + contract_exporta(file_path : string)
    + undo()
  }
}

package Test{
class TesteDiscipline <<Test>>{
    - test_validare()
    - test_adaugare(service : ServiceDisciplina)
    - test_modificare(service : ServiceDisciplina)
    - test_stergere(service : ServiceDisciplina)
    - test_undo(service : ServiceDisciplina)
    - test_memorie()
    - test_fisiere()
    - test_falsitate()
    - test_cautare()
    - test_filtrare()
    - test_sortare()
    - test_contract_adaugare()
    - test_contract_goleste()
    - test_contract_generare()
    - test_raport_tip()
    + testAll()
  }
}

package UI{
class Consola <<UI>>{
    - ServiceDisciplina& service
    + run()
    + executa_comanda(comanda : int, rulare : bool)
    + preload_data(service : ServiceDisciplina)
    + ui_adaugare()
    + ui_modificare()
    + ui_stergere()
    + ui_cautare()
    + ui_filtrare()
    + ui_sortare()
    + ui_afisare(vector<Disciplina>)
    + ui_meniu()
    + citeste_int(mesaj : string) : int
    + citeste_string(mesaj : string) : string
    + ui_contract()
    + ui_contract_adauga()
    + ui_contract_goleste()
    + ui_contract_random()
    + ui_raport_tip()
    + ui_contract_export()
    + ui_undo()
  }
}



ValidationException --|> BaseException
RepoException --|> BaseException
ContractException --|> BaseException
FileException --|> BaseException

Validator ..> Disciplina
Validator ..> ValidationException
Validator ..> RepoException
Validator ..> ContractException
Validator ..> FileException

IRepoDisciplina ..> Validator
RepoDisciplinaMem --|> IRepoDisciplina
RepoDisciplinaFals --|> IRepoDisciplina
RepoDisciplinaFile --|> RepoDisciplinaMem

ContractStudii ..> Validator

ActiuneUndo ..> IRepoDisciplina
UndoAdauga --|> ActiuneUndo
UndoModifica --|> ActiuneUndo
UndoSterge --|> ActiuneUndo


ServiceDisciplina ..> ReportDTO
ServiceDisciplina ..> ActiuneUndo
ServiceDisciplina ..> ContractStudii

Consola ..> ServiceDisciplina
@enduml